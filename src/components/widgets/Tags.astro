---
const { tags = [], size = "sm" } = Astro.props;

if (!tags || tags.length === 0) return null;

const sizeClasses = {
  xs: "text-xs px-2 py-0.5",
  sm: "text-sm px-2.5 py-1",
  md: "text-base px-3 py-1.5",
};

// Color palette for tags - darker shades for better white text contrast
// On hover: even darker for visual feedback
const colorPalette = [
  { bg: "bg-rose-600", hover: "hover:bg-rose-700" },
  { bg: "bg-pink-600", hover: "hover:bg-pink-700" },
  { bg: "bg-fuchsia-600", hover: "hover:bg-fuchsia-700" },
  { bg: "bg-purple-600", hover: "hover:bg-purple-700" },
  { bg: "bg-violet-600", hover: "hover:bg-violet-700" },
  { bg: "bg-indigo-600", hover: "hover:bg-indigo-700" },
  { bg: "bg-blue-600", hover: "hover:bg-blue-700" },
  { bg: "bg-cyan-700", hover: "hover:bg-cyan-800" },
  { bg: "bg-teal-600", hover: "hover:bg-teal-700" },
  { bg: "bg-emerald-600", hover: "hover:bg-emerald-700" },
  { bg: "bg-green-600", hover: "hover:bg-green-700" },
  { bg: "bg-lime-600", hover: "hover:bg-lime-700" },
  { bg: "bg-amber-600", hover: "hover:bg-amber-700" },
  { bg: "bg-orange-600", hover: "hover:bg-orange-700" },
  { bg: "bg-red-600", hover: "hover:bg-red-700" },
];

// Override specific tags with brand colors
const tagColorOverrides: Record<string, { bg: string; hover: string }> = {
  "aws": { bg: "bg-orange-500", hover: "hover:bg-orange-600" },
};

// Generate consistent color index based on tag string
const getColorIndex = (tag: string) => {
  let hash = 0;
  for (let i = 0; i < tag.length; i++) {
    hash = ((hash << 5) - hash) + tag.charCodeAt(i);
    hash = hash & hash;
  }
  return Math.abs(hash) % colorPalette.length;
};

// Get color for a tag (check overrides first, then use hash)
const getTagColor = (tag: string) => {
  const lowerTag = tag.toLowerCase();
  if (tagColorOverrides[lowerTag]) {
    return tagColorOverrides[lowerTag];
  }
  return colorPalette[getColorIndex(tag)];
};

const sizeClass = sizeClasses[size] || sizeClasses.sm;
---

<div class="flex flex-wrap gap-2 items-center">
  {tags.map((tag) => {
    const color = getTagColor(tag);
    return (
      <a
        href={`/tags/${tag.toLowerCase()}`}
        class={`inline-flex items-center gap-1 ${sizeClass} rounded-md
                ${color.bg} ${color.hover}
                !text-white !no-underline hover:!text-white visited:!text-white
                font-medium
                transition-colors duration-200`}
        title={`View all posts tagged with ${tag}`}
      >
        <span aria-hidden="true">#</span>
        <span>{tag}</span>
      </a>
    );
  })}
</div>
